{"ast":null,"code":"var _jsxFileName = \"/home/ishan/dissertation/frontend/src/Recorder.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport audioBufferToWav from 'audiobuffer-to-wav';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Recorder = () => {\n  _s();\n  const [recording, setRecording] = useState(false);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n  const startRecording = () => {\n    navigator.mediaDevices.getUserMedia({\n      audio: true\n    }).then(stream => {\n      mediaRecorderRef.current = new MediaRecorder(stream);\n      mediaRecorderRef.current.addEventListener('dataavailable', handleDataAvailable);\n      mediaRecorderRef.current.start();\n      setRecording(true);\n    });\n  };\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n      mediaRecorderRef.current.stop();\n      setRecording(false);\n    }\n  };\n  const handleDataAvailable = e => {\n    if (e.data.size > 0) {\n      audioChunksRef.current.push(e.data);\n    }\n  };\n  const handleUpload = () => {\n    const audioBuffer = audioCtx.createBuffer(1, audioChunksRef.current.length, audioCtx.sampleRate);\n    audioBuffer.getChannelData(0).set(audioChunksRef.current);\n\n    // Convert the AudioBuffer to a WAV file\n    const wavData = audioBufferToWav(audioBuffer);\n\n    // Send the .wav file to the server using an HTTP request\n    fetch('http://127.0.0.1:5000/audio-upload', {\n      mode: 'no-cors',\n      method: 'POST',\n      body: wavData.buffer,\n      headers: {\n        'Content-Type': 'audio/wav'\n      }\n    }).then(response => response.text()).then(data => {\n      console.log(data);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: startRecording,\n      disabled: recording,\n      children: \"Start Recording\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: stopRecording,\n      disabled: !recording,\n      children: \"Stop Recording\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleUpload,\n      disabled: audioChunksRef.current.length === 0,\n      children: \"Upload Audio\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(Recorder, \"iihCjkzL20K33vHj1iywA3a+uCE=\");\n_c = Recorder;\nexport default Recorder;\nvar _c;\n$RefreshReg$(_c, \"Recorder\");","map":{"version":3,"names":["React","useState","useRef","audioBufferToWav","Recorder","recording","setRecording","mediaRecorderRef","audioChunksRef","audioCtx","window","AudioContext","webkitAudioContext","startRecording","navigator","mediaDevices","getUserMedia","audio","then","stream","current","MediaRecorder","addEventListener","handleDataAvailable","start","stopRecording","state","stop","e","data","size","push","handleUpload","audioBuffer","createBuffer","length","sampleRate","getChannelData","set","wavData","fetch","mode","method","body","buffer","headers","response","text","console","log","catch","err"],"sources":["/home/ishan/dissertation/frontend/src/Recorder.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport audioBufferToWav from 'audiobuffer-to-wav';\n\nconst Recorder = () => {\n  const [recording, setRecording] = useState(false);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n\n  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n\n  const startRecording = () => {\n    navigator.mediaDevices.getUserMedia({ audio: true })\n      .then(stream => {\n        mediaRecorderRef.current = new MediaRecorder(stream);\n        mediaRecorderRef.current.addEventListener('dataavailable', handleDataAvailable);\n        mediaRecorderRef.current.start();\n        setRecording(true);\n      });\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n      mediaRecorderRef.current.stop();\n      setRecording(false);\n    }\n  };\n\n  const handleDataAvailable = e => {\n    if (e.data.size > 0) {\n      audioChunksRef.current.push(e.data);\n    }\n  };\n\n  const handleUpload = () => {\n    const audioBuffer = audioCtx.createBuffer(1, audioChunksRef.current.length, audioCtx.sampleRate);\n    audioBuffer.getChannelData(0).set(audioChunksRef.current);\n\n    // Convert the AudioBuffer to a WAV file\n    const wavData = audioBufferToWav(audioBuffer);\n\n      // Send the .wav file to the server using an HTTP request\n      fetch('http://127.0.0.1:5000/audio-upload', {\n        mode: 'no-cors',\n        method: 'POST',\n        body: wavData.buffer,\n        headers: {\n          'Content-Type': 'audio/wav'\n        }\n      }).then(response => response.text()).then(data => {\n        console.log(data);\n        }).catch(err => {\n            console.log(err);\n        });\n\n  };\n\n  return (\n    <div>\n      <button onClick={startRecording} disabled={recording}>Start Recording</button>\n      <button onClick={stopRecording} disabled={!recording}>Stop Recording</button>\n      <button onClick={handleUpload} disabled={audioChunksRef.current.length === 0}>Upload Audio</button>\n    </div>\n  );\n};\n\nexport default Recorder;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}